if (self.CavalryLogger) { CavalryLogger.start_js(["9gnQX"]); }

__d("AudioEvents",[],(function a(b,c,d,e,f,g){f.exports={CREATE_STREAM:"AUDIO_CREATE_STREAM",FINISH:"AUDIO_FINISH",LOAD:"AUDIO_LOAD",MUTE:"AUDIO_MUTE",PAUSE:"AUDIO_PAUSE",PLAY:"AUDIO_PLAY",REPLAY:"AUDIO_REPLAY",SCRUB_BEGIN:"AUDIO_SCRUB_BEGIN",SCRUB_END:"AUDIO_SCRUB_END",SEEK:"AUDIO_SEEK",STREAM_CHANGE:"AUDIO_STREAM_CHANGE",UNMUTE:"AUDIO_UNMUTE",UPDATE_BUFFER:"AUDIO_UPDATE_BUFFER",UPDATE_DURATION:"AUDIO_UPDATE_DURATION",UPDATE_TIME:"AUDIO_UPDATE_TIME",VOLUME_CHANGE:"AUDIO_VOLUME_CHANGE",REPLACE_STREAM:"AUDIO_REPLACE_STREAM",FETCH_URL:"AUDIO_FETCH_URL",BLOCK_FETCH:"AUDIO_BLOCK_FETCH",ALLOW_FETCH:"AUDIO_ALLOW_FETCH",SOUNDCLOUD_CHECKPOINT:"AUDIO_SOUNDCLOUD_CHECKPOINT"};}),null);
__d("MusicStoryLoggerEvents",[],(function a(b,c,d,e,f,g){f.exports={CTA_CLICK:"music_cta_click",ERROR:"music_error",OPEN:"music_open",PAUSE:"music_pause",PLAY:"music_play",PLAY_REQUESTED:"music_play_requested",REACHED_END:"music_reached_end",STALL:"music_stall",SOUNDCLOUD_CHECKPOINT:"music_soundcloud_checkpoint"};}),null);
__d("XSpotifyWebAPIControllerConstants",[],(function a(b,c,d,e,f,g){f.exports={API_URL:"https:\/\/api.spotify.com",AUTH_URL:"https:\/\/accounts.spotify.com",AUTH_PATH:"\/authorize",CLIENT_ID_QUERY_PARAM:"client_id",RESPONSE_TYPE_QUERY_PARAM:"response_type",REDIRECT_URI_QUERY_PARAM:"redirect_uri",SCOPE_QUERY_PARAM:"scope",SHOW_DIALOG_QUERY_PARAM:"show_dialog",STATE_QUERY_PARAM:"state",GRAPHQL_REDIRECT_URI:"https:\/\/m.facebook.com\/spotify_callback",SCOPES:"user-library-modify user-library-read",AUTH_SUCCESS:"SPOTIFY_WEB_API_CONTROLLER_CONSTANTS_AUTH_SUCCESS",LOGIN_REQUIRED:"SPOTIFY_WEB_API_CONTROLLER_CONSTANTS_LOGIN_REQUIRED",SAVE_SUCCESS:"SPOTIFY_WEB_API_CONTROLLER_CONSTANTS_SAVE_SUCCESS",SAVE_FAILED:"SPOTIFY_WEB_API_CONTROLLER_CONSTANTS_SAVE_FAILED",UNSAVE_SUCCESS:"SPOTIFY_WEB_API_CONTROLLER_CONSTANTS_UNSAVE_SUCCESS",UNSAVE_FAILED:"SPOTIFY_WEB_API_CONTROLLER_CONSTANTS_UNSAVE_FAILED",UTM_SOURCE_QUERY_PARAM:"utm_source",UTM_MEDIUM_QUERY_PARAM:"utm_medium",UTM_CAMPAIGN_QUERY_PARAM:"utm_campaign",UTM_CONTENT_QUERY_PARAM:"utm_content",UTM_TERM_QUERY_PARAM:"utm_term"};}),null);
__d('Audio',['AudioEvents','EventEmitter','Map','Run','nullthrows'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('EventEmitter'));i=h&&h.prototype;function j(){'use strict';i.constructor.call(this);this.resetAudioStreams();c('Run').onLeave(this.$Audio3.bind(this));}j.prototype.addStream=function(k,l){'use strict';if(!this.$Audio1.has(k)){this.$Audio1.set(k,[]);this.$Audio2.set(k,[]);}var m=c('nullthrows')(this.$Audio1.get(k)).length,n=this.$Audio4(k,m,l.preload);c('nullthrows')(this.$Audio1.get(k)).push(n);c('nullthrows')(this.$Audio2.get(k)).push(false);return m;};j.prototype.play=function(k,l){'use strict';if(!this.$Audio1.has(k)||c('nullthrows')(this.$Audio2.get(k))[l])return;c('nullthrows')(this.$Audio1.get(k))[l].play();c('nullthrows')(this.$Audio2.get(k))[l]=true;};j.prototype.pause=function(k,l){'use strict';if(!this.$Audio1.has(k)||!c('nullthrows')(this.$Audio2.get(k))[l])return;c('nullthrows')(this.$Audio1.get(k))[l].pause();c('nullthrows')(this.$Audio2.get(k))[l]=false;};j.prototype.seek=function(k,l,m){'use strict';c('nullthrows')(this.$Audio1.get(k))[l].currentTime=m;};j.prototype.setVolume=function(k,l,m){'use strict';c('nullthrows')(this.$Audio1.get(k))[l].volume=m;};j.prototype.mute=function(k,l){'use strict';c('nullthrows')(this.$Audio1.get(k))[l].muted=true;};j.prototype.unmute=function(k,l){'use strict';c('nullthrows')(this.$Audio1.get(k))[l].muted=false;};j.prototype.getBufferedPosition=function(k,l){'use strict';var m=c('nullthrows')(this.$Audio1.get(k))[l].buffered,n=m.length;return n?m.end(n-1):0;};j.prototype.getDuration=function(k,l){'use strict';return c('nullthrows')(this.$Audio1.get(k))[l].duration;};j.prototype.getAudioStream=function(k){'use strict';return this.$Audio1.get(k);};j.prototype.getIsPlaying=function(k){'use strict';return this.$Audio2.get(k);};j.prototype.resetAudioStreams=function(){'use strict';this.$Audio1=new (c('Map'))();this.$Audio2=new (c('Map'))();};j.prototype.$Audio3=function(){'use strict';c('Run').onAfterLoad(function(){c('Run').onLeave(this.$Audio3.bind(this));}.bind(this));for(var k=this.$Audio2,l=Array.isArray(k),m=0,k=l?k:k[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var n;if(l){if(m>=k.length)break;n=k[m++];}else{m=k.next();if(m.done)break;n=m.value;}var o=n,p=o[0],q=o[1];for(var r=0,s;r<q.length;r++){s=q[r];if(s){var t=c('nullthrows')(this.$Audio1.get(p))[r];t.pause();t.remove();}}}this.resetAudioStreams();};j.prototype.$Audio4=function(k,l,m){'use strict';var n=document.createElement('audio');n.setAttribute('preload',m?'auto':'metadata');n.addEventListener('loadedmetadata',function(o){this.$Audio5(c('AudioEvents').UPDATE_DURATION,k,l,n.duration);}.bind(this));n.addEventListener('progress',function(o){var p=n.buffered.length;this.$Audio5(c('AudioEvents').UPDATE_BUFFER,k,l,p?n.buffered.end(p-1):0);}.bind(this));n.addEventListener('timeupdate',function(o){this.$Audio5(c('AudioEvents').UPDATE_TIME,k,l,n.currentTime);}.bind(this));n.addEventListener('ended',function(o){this.$Audio5(c('AudioEvents').FINISH,k,l);}.bind(this));n.src=k;return n;};j.prototype.$Audio5=function(k,l,m,n){'use strict';var o={uri:l,index:m,value:n};this.emit(k,o);};f.exports=new j();}),null);
__d('MusicStoryTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g){'use strict';function h(){this.clear();}h.prototype.log=function(){c('GeneratedLoggerUtils').log('music_story_logger:MusicStoryLoggerConfig',this.$MusicStoryTypedLogger1,c('Banzai').BASIC);};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('music_story_logger:MusicStoryLoggerConfig',this.$MusicStoryTypedLogger1,c('Banzai').VITAL);};h.prototype.clear=function(){this.$MusicStoryTypedLogger1={};return this;};h.prototype.updateData=function(j){this.$MusicStoryTypedLogger1=babelHelpers['extends']({},this.$MusicStoryTypedLogger1,j);return this;};h.prototype.setAlbumTitle=function(j){this.$MusicStoryTypedLogger1.album_title=j;return this;};h.prototype.setArtistName=function(j){this.$MusicStoryTypedLogger1.artist_name=j;return this;};h.prototype.setAudioDurationMs=function(j){this.$MusicStoryTypedLogger1.audio_duration_ms=j;return this;};h.prototype.setAudioTitle=function(j){this.$MusicStoryTypedLogger1.audio_title=j;return this;};h.prototype.setClientUserID=function(j){this.$MusicStoryTypedLogger1.client_userid=j;return this;};h.prototype.setContainermodule=function(j){this.$MusicStoryTypedLogger1.containermodule=j;return this;};h.prototype.setContentID=function(j){this.$MusicStoryTypedLogger1.content_id=j;return this;};h.prototype.setCtaAction=function(j){this.$MusicStoryTypedLogger1.cta_action=j;return this;};h.prototype.setError=function(j){this.$MusicStoryTypedLogger1.error=j;return this;};h.prototype.setEvent=function(j){this.$MusicStoryTypedLogger1.event=j;return this;};h.prototype.setHasMinutiae=function(j){this.$MusicStoryTypedLogger1.has_minutiae=j;return this;};h.prototype.setMinutiaeID=function(j){this.$MusicStoryTypedLogger1.minutiae_id=j;return this;};h.prototype.setMusicID=function(j){this.$MusicStoryTypedLogger1.music_id=j;return this;};h.prototype.setPlatformName=function(j){this.$MusicStoryTypedLogger1.platform_name=j;return this;};h.prototype.setPlayDurationMs=function(j){this.$MusicStoryTypedLogger1.play_duration_ms=j;return this;};h.prototype.setPlaylistName=function(j){this.$MusicStoryTypedLogger1.playlist_name=j;return this;};h.prototype.setStallDurationMs=function(j){this.$MusicStoryTypedLogger1.stall_duration_ms=j;return this;};h.prototype.setStartDelayMs=function(j){this.$MusicStoryTypedLogger1.start_delay_ms=j;return this;};h.prototype.setStoryType=function(j){this.$MusicStoryTypedLogger1.story_type=j;return this;};h.prototype.setUnplayedBufferTimeMs=function(j){this.$MusicStoryTypedLogger1.unplayed_buffer_time_ms=j;return this;};var i={album_title:true,artist_name:true,audio_duration_ms:true,audio_title:true,client_userid:true,containermodule:true,content_id:true,cta_action:true,error:true,event:true,has_minutiae:true,minutiae_id:true,music_id:true,platform_name:true,play_duration_ms:true,playlist_name:true,stall_duration_ms:true,start_delay_ms:true,story_type:true,unplayed_buffer_time_ms:true};f.exports=h;}),null);
__d('MusicStoryDispatcher',['ExplicitRegistrationDispatcher'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('ExplicitRegistrationDispatcher'));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this,k);this.dispatch=this.dispatch.bind(this);}f.exports=new j({strict:true});}),null);
__d('MusicStoryAudioActions',['AudioEvents','AudioStream','MusicStoryDispatcher'],(function a(b,c,d,e,f,g){var h={createStream:function i(j,k,l,m,n){var o={type:c('AudioEvents').CREATE_STREAM,titleUriList:j,uniqueId:l,extraData:m,isDynamicUri:n};if(k)o.loggingData=k;c('MusicStoryDispatcher').dispatch(o);},play:function i(j){var k={type:c('AudioEvents').PLAY,uniqueId:j};c('MusicStoryDispatcher').dispatch(k);},pause:function i(j){var k={type:c('AudioEvents').PAUSE,uniqueId:j};c('MusicStoryDispatcher').dispatch(k);},scrubBegin:function i(j){var k={type:c('AudioEvents').SCRUB_BEGIN,uniqueId:j};c('MusicStoryDispatcher').dispatch(k);},scrubEnd:function i(j,k){var l={type:c('AudioEvents').SCRUB_END,uniqueId:j,value:k};c('MusicStoryDispatcher').dispatch(l);},mute:function i(j){var k={type:c('AudioEvents').MUTE,uniqueId:j};c('MusicStoryDispatcher').dispatch(k);},unmute:function i(j){var k={type:c('AudioEvents').UNMUTE,uniqueId:j};c('MusicStoryDispatcher').dispatch(k);},setVolume:function i(j,k){var l={type:c('AudioEvents').VOLUME_CHANGE,uniqueId:j,value:k};c('MusicStoryDispatcher').dispatch(l);},updatePlaybackPos:function i(j,k){var l={type:c('AudioEvents').UPDATE_TIME,uniqueId:j,value:k};if(!c('MusicStoryDispatcher').isDispatching())c('MusicStoryDispatcher').dispatch(l);},updateDuration:function i(j,k,l,m){var n={type:c('AudioEvents').UPDATE_DURATION,uniqueId:j,value:k,uri:l,copyNumber:m};c('MusicStoryDispatcher').dispatch(n);},updateBufferedPos:function i(j,k){var l={type:c('AudioEvents').UPDATE_BUFFER,uniqueId:j,value:k};if(!c('MusicStoryDispatcher').isDispatching())c('MusicStoryDispatcher').dispatch(l);},updateIsFinished:function i(j){var k={type:c('AudioEvents').FINISH,uniqueId:j};c('MusicStoryDispatcher').dispatch(k);},changeStream:function i(j,k,l){var m={type:c('AudioEvents').STREAM_CHANGE,uniqueId:j,value:k,previousTitle:l};c('MusicStoryDispatcher').dispatch(m);},deleteStream:function i(j){var k={type:c('AudioEvents').DELETE_STREAM,uniqueId:j};c('MusicStoryDispatcher').dispatch(k);},replaceStream:function i(j,k){var l={type:c('AudioEvents').REPLACE_STREAM,stream:k,uniqueId:j};c('MusicStoryDispatcher').dispatch(l);},fetchURL:function i(j,k){var l=arguments.length<=2||arguments[2]===undefined?-1:arguments[2],m={type:c('AudioEvents').FETCH_URL,uniqueId:j,subsequentAction:k,value:l};c('MusicStoryDispatcher').dispatch(m);},blockFetches:function i(j){var k={type:c('AudioEvents').BLOCK_FETCH,uniqueId:j};c('MusicStoryDispatcher').dispatch(k);},allowFetches:function i(j){var k={type:c('AudioEvents').ALLOW_FETCH,uniqueId:j};c('MusicStoryDispatcher').dispatch(k);}};f.exports=h;}),null);
__d('AudioMetaData',['immutable'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('immutable').Record({title:'',uri:'',duration:0,copyNumber:-1,dynamicUri:'',playbackPosition:-1,soundcloudBeacons:null}));i=h&&h.prototype;function j(){'use strict';h.apply(this,arguments);}f.exports=j;}),null);
__d('AudioStream',['Audio','AudioEvents','AudioMetaData','Arbiter','immutable','MusicStoryAudioActions','SubscriptionsHandler','curry'],(function a(b,c,d,e,f,g){var h,i,j=1000,k={bufferedPosition:0,duration:0,isDynamicUri:false,isFinished:false,isMuted:false,isPlaying:false,isScrubbing:false,playbackPosition:0,audioMetaDataList:c('immutable').List(),activeTrack:0,volume:1,subscriptions:new (c('SubscriptionsHandler'))(),storyIdentifier:null,blockFetches:false},l=[c('AudioEvents').UPDATE_TIME,c('AudioEvents').UPDATE_DURATION,c('AudioEvents').UPDATE_BUFFER,c('AudioEvents').FINISH];h=babelHelpers.inherits(m,c('immutable').Record(k));i=h&&h.prototype;m.createStream=function(n,o,p,q){'use strict';var r=new m(),s=new (c('immutable').List)(),t=void 0,u=p.storyIdentifier,v=p.isPermalink;if(u)r.subscriptions.addSubscriptions(c('Arbiter').subscribe('Story/delete',c('curry')(m.$AudioStream1,o,u)));for(var w=0,x;w<n.length;w++){x=n[w];t=m.createMetaData(x);if(!q)t=m.createAudio(t,o,w,v,q);s=s.push(t);}return r.set('audioMetaDataList',s).set('isDynamicUri',q).set('storyIdentifier',u);};m.createMetaData=function(n){'use strict';return new (c('AudioMetaData'))({title:n.title,uri:n.uri});};m.createAudio=function(n,o,p,q,r){'use strict';var s=n.get(r?'dynamicUri':'uri'),t=c('Audio').addStream(s,{preload:q&&p===0});n=n.set('copyNumber',t);for(var u=l,v=Array.isArray(u),w=0,u=v?u:u[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var x;if(v){if(w>=u.length)break;x=u[w++];}else{w=u.next();if(w.done)break;x=w.value;}var y=x;c('Audio').addListener(y,m.updatePropertyCallback(o,s,n.get('copyNumber'),y));}if(n.get('playbackPosition')>0)c('Audio').seek(s,t,n.get('playbackPosition'));return n;};m.updatePropertyCallback=function(n,o,p,event){'use strict';var q=void 0;switch(event){case c('AudioEvents').UPDATE_TIME:q=c('MusicStoryAudioActions').updatePlaybackPos;break;case c('AudioEvents').UPDATE_DURATION:q=c('MusicStoryAudioActions').updateDuration;break;case c('AudioEvents').UPDATE_BUFFER:q=c('MusicStoryAudioActions').updateBufferedPos;break;case c('AudioEvents').FINISH:q=c('MusicStoryAudioActions').updateIsFinished;break;}return function(r){if(r.uri===o&&r.index===p)q(n,r.value,r.uri,r.index);};};m.prototype.play=function(){'use strict';var n=this.get('isDynamicUri')?this.getActiveDynamicUri():this.getActiveUri();c('Audio').play(n,this.getActiveCopyNo());};m.prototype.pause=function(){'use strict';var n=this.get('isDynamicUri')?this.getActiveDynamicUri():this.getActiveUri();c('Audio').pause(n,this.getActiveCopyNo());};m.prototype.mute=function(){'use strict';var n=this.get('isDynamicUri')?this.getActiveDynamicUri():this.getActiveUri();c('Audio').mute(n,this.getActiveCopyNo());};m.prototype.unmute=function(){'use strict';var n=this.get('isDynamicUri')?this.getActiveDynamicUri():this.getActiveUri();c('Audio').unmute(n,this.getActiveCopyNo());};m.prototype.seek=function(n){'use strict';var o=this.get('isDynamicUri')?this.getActiveDynamicUri():this.getActiveUri();c('Audio').seek(o,this.getActiveCopyNo(),n);};m.prototype.changeVolume=function(n){'use strict';var o=this.get('isDynamicUri')?this.getActiveDynamicUri():this.getActiveUri();c('Audio').setVolume(o,this.getActiveCopyNo(),n);};m.prototype.getActiveTrackTitle=function(){'use strict';var n=this.get('audioMetaDataList'),o=this.get('activeTrack');return n.get(o).title;};m.prototype.getActiveTrackDurationMs=function(){'use strict';var n=this.get('audioMetaDataList'),o=this.get('activeTrack'),p=n.get(o).duration;return Math.floor(p*j);};m.prototype.getActiveUri=function(){'use strict';var n=this.get('audioMetaDataList').get(this.get('activeTrack'));return n.get('uri');};m.prototype.getActiveDynamicUri=function(){'use strict';var n=this.get('audioMetaDataList').get(this.get('activeTrack'));return n.get('dynamicUri');};m.prototype.getActiveCopyNo=function(){'use strict';var n=this.get('audioMetaDataList').get(this.get('activeTrack'));return n.get('copyNumber');};m.prototype.getBufferedPosition=function(){'use strict';return c('Audio').getBufferedPosition(this.getActiveUri(),this.getActiveCopyNo());};m.prototype.getActiveMetaData=function(){'use strict';return this.get('audioMetaDataList').get(this.get('activeTrack'));};m.$AudioStream1=function(n,o,p,q){'use strict';if(o!==q)return;c('MusicStoryAudioActions').deleteStream(n);};function m(){'use strict';h.apply(this,arguments);}f.exports=m;}),null);
__d("XSoundCloudAudioURLController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/music\/soundcloud\/exchange_url\/",{});}),null);
__d('MusicStoryAudioStore',['AsyncRequest','AudioEvents','AudioStream','FluxReduceStore','immutable','MusicStoryDispatcher','XSoundCloudAudioURLController','MusicStoryAudioActions'],(function a(b,c,d,e,f,g){var h,i,j,k,l={streams:c('immutable').Map()};h=babelHelpers.inherits(m,c('immutable').Record(l));i=h&&h.prototype;m.prototype.getStream=function(o){'use strict';return this.get('streams').get(o);};m.prototype.setStream=function(o,p){'use strict';return this.get('streams').set(o,p);};function m(){'use strict';h.apply(this,arguments);}j=babelHelpers.inherits(n,c('FluxReduceStore'));k=j&&j.prototype;n.prototype.getInitialState=function(){'use strict';return new m();};n.prototype.getStream=function(o){'use strict';return this.getState().getStream(o);};n.prototype.getBeacons=function(o){'use strict';return this.getStream(o).getActiveMetaData().get('soundcloudBeacons');};n.prototype.getActiveTrackTitle=function(o){'use strict';var p=this.getState().getStream(o);return p.getActiveTrackTitle();};n.prototype.getActiveTrackDurationMs=function(o){'use strict';var p=this.getState().getStream(o);return p.getActiveTrackDurationMs();};n.prototype.getIsPlaying=function(o){'use strict';return this.getState().getStream(o).get('isPlaying');};n.prototype.getIsDynamicURL=function(o){'use strict';return this.getState().getStream(o).get('isDynamicUri');};n.prototype.reduce=function(o,p){'use strict';var q=void 0,r=p.uniqueId;switch(p.type){case c('AudioEvents').CREATE_STREAM:q=c('AudioStream').createStream(p.titleUriList,r,p.extraData,p.isDynamicUri);o=o.set('streams',o.setStream(r,q));return o;case c('AudioEvents').REPLACE_STREAM:o=o.set('streams',o.setStream(r,p.stream));return o;case c('AudioEvents').BLOCK_FETCH:q=o.getStream(r);q=q.set('blockFetches',true);o=this.doBooleanAction(o,r,c('AudioEvents').PAUSE);o=o.set('streams',o.setStream(r,q));return o;case c('AudioEvents').ALLOW_FETCH:q=o.getStream(r);q=q.set('blockFetches',false);o=o.set('streams',o.setStream(r,q));return o;case c('AudioEvents').FETCH_URL:this.fetchDynamicUri(o.getStream(r),r,p.subsequentAction,p.value);return o;case c('AudioEvents').PLAY:case c('AudioEvents').PAUSE:case c('AudioEvents').MUTE:case c('AudioEvents').UNMUTE:return this.doBooleanAction(o,r,p.type);case c('AudioEvents').VOLUME_CHANGE:return this.doNumericAction(o,r,p.type,p.value);case c('AudioEvents').SCRUB_BEGIN:if(o.getStream(r).get('isPlaying'))o=this.doBooleanAction(o,r,p.type);o=this.setProperty(o,r,'isScrubbing',true);return o;case c('AudioEvents').SCRUB_END:if(o.getStream(r).get('isPlaying'))o=this.doBooleanAction(o,r,p.type);if(o.getStream(r).get('isFinished'))o=this.doBooleanAction(o,r,c('AudioEvents').PLAY);o=this.doNumericAction(o,r,p.type,p.value);o=this.setProperty(o,r,'isScrubbing',false);return o;case c('AudioEvents').UPDATE_TIME:o=this.setProperty(o,r,'playbackPosition',p.value);return this.setMetaDataProperty(o,r,'playbackPosition',p.value);case c('AudioEvents').UPDATE_DURATION:return this.setDuration(o,r,p.uri,p.copyNumber,p.value);case c('AudioEvents').UPDATE_BUFFER:return this.setProperty(o,r,'bufferedPosition',p.value);case c('AudioEvents').FINISH:return this.setIsFinished(o,r,true);case c('AudioEvents').STREAM_CHANGE:return this.changeActiveStream(o,r,p.value);default:return o;}};n.prototype.deleteStream=function(o,p){'use strict';return this.doBooleanAction(o,p,c('AudioEvents').PAUSE);};n.prototype.changeActiveStream=function(o,p,q){'use strict';var r=o.getStream(p),s=r.get('isMuted'),t=r.get('volume');o=this.doBooleanAction(o,p,c('AudioEvents').PAUSE);o=this.doNumericAction(o,p,c('AudioEvents').SCRUB_END,0);o=this.setProperty(o,p,'activeTrack',q);var u=this.getBufferedPosition(o,p);o=this.setProperty(o,p,'bufferedPosition',u);o=this.setProperty(o,p,'duration',this.getTrackDuration(o,p,q));o=s?this.doBooleanAction(o,p,c('AudioEvents').MUTE):this.doBooleanAction(o,p,c('AudioEvents').UNMUTE);o=this.doNumericAction(o,p,c('AudioEvents').VOLUME_CHANGE,t);o=this.doBooleanAction(o,p,c('AudioEvents').PLAY);return o;};n.prototype.getBufferedPosition=function(o,p){'use strict';var q=o.getStream(p);return q.getBufferedPosition();};n.prototype.getTrackDuration=function(o,p,q){'use strict';var r=o.getStream(p),s=r.get('audioMetaDataList');return s.get(q).duration;};n.prototype.setDuration=function(o,p,q,r,s){'use strict';var t=0,u=false,v=o.getStream(p),w=v.get('audioMetaDataList');w=w.map(function(x){var y=v.get('isDynamicUri')?x.get('dynamicUri'):x.get('uri');if(y===q&&x.copyNumber===r){x=x.set('duration',s);if(t===v.get('activeTrack'))u=true;}t++;return x;});v=v.set('audioMetaDataList',w);o=o.set('streams',o.setStream(p,v));if(u)o=this.setProperty(o,p,'duration',s);return o;};n.prototype.setIsFinished=function(o,p,q){'use strict';o=this.doBooleanAction(o,p,c('AudioEvents').PAUSE);o=this.setMetaDataProperty(o,p,'playbackPosition',-1);return this.setProperty(o,p,'isFinished',q);};n.prototype.doBooleanAction=function(o,p,q){'use strict';var r=[],s=[],t=o.getStream(p);s.push(q===c('AudioEvents').PLAY||q===c('AudioEvents').MUTE||q===c('AudioEvents').SCRUB_BEGIN);if(q===c('AudioEvents').PLAY||q===c('AudioEvents').PAUSE){r.push('isPlaying');var u=o.getStream(p).get('isFinished');if(q===c('AudioEvents').PLAY&&u){r.push('isFinished');s.push(false);}}else if(q===c('AudioEvents').MUTE||q===c('AudioEvents').UNMUTE)r.push('isMuted');switch(q){case c('AudioEvents').PLAY:case c('AudioEvents').SCRUB_END:t.play();break;case c('AudioEvents').PAUSE:case c('AudioEvents').SCRUB_BEGIN:t.pause();break;case c('AudioEvents').MUTE:t.mute();break;case c('AudioEvents').UNMUTE:t.unmute();break;default:throw new Error('Unsupported boolean action: '+q);}for(var v=0;v<r.length;v++)o=this.setProperty(o,p,r[v],s[v]);return o;};n.prototype.fetchDynamicUri=function(o,p,q,r){'use strict';new (c('AsyncRequest'))().setURI(c('XSoundCloudAudioURLController').getURIBuilder().getURI()).setMethod('POST').setData({endpoint_url:o.getActiveUri()}).setHandler(function(s){var t=s.payload.media,u=s.payload.beacons,v=o.getActiveMetaData(),w=document.createElement('audio'),x=w.canPlayType('application/vnd.apple.mpegURL')!=='',y=x?t.hls:t.http;v=v.set('dynamicUri',y);v=v.set('soundcloudBeacons',u);v=c('AudioStream').createAudio(v,p,-1,false,true);var z=o.get('audioMetaDataList').set(o.get('activeTrack'),v);o=o.set('audioMetaDataList',z);c('MusicStoryAudioActions').replaceStream(p,o);switch(q){case c('AudioEvents').PLAY:c('MusicStoryAudioActions').play(p,u.play);break;case c('AudioEvents').SCRUB_END:c('MusicStoryAudioActions').scrubEnd(p,r);break;default:break;}c('MusicStoryAudioActions').allowFetches(p);}).setErrorHandler(function(s){}).send();};n.prototype.doNumericAction=function(o,p,q,r){'use strict';var s=void 0,t=o.getStream(p);if(q===c('AudioEvents').SCRUB_END){t.seek(r);s='playbackPosition';}else if(q===c('AudioEvents').VOLUME_CHANGE){t.changeVolume(r);s='volume';}else throw new Error('Unsupported integer action: '+q);return this.setProperty(o,p,s,r);};n.prototype.setProperty=function(o,p,q,r){'use strict';var s=o.getStream(p);s=s.set(q,r);return o.set('streams',o.setStream(p,s));};n.prototype.setMetaDataProperty=function(o,p,q,r){'use strict';var s=o.getStream(p),t=s.get('activeTrack'),u=s.get('audioMetaDataList'),v=u.get(t);v=v.set(q,r);u=u.set(t,v);s=s.set('audioMetaDataList',u);return o.set('streams',o.setStream(p,s));};function n(){'use strict';j.apply(this,arguments);}f.exports=new n(c('MusicStoryDispatcher'));}),null);
__d('MusicStoryBanzaiFeedLogger',['Banzai'],(function a(b,c,d,e,f,g){var h={logOutboundClick:function i(j){if(j)c('Banzai').post('music_story_outbound_click',j);}};f.exports=h;}),null);
__d('MusicStoryEventLogger',['MusicStoryLoggerEvents','MusicStoryTypedLogger'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('MusicStoryTypedLogger'));i=h&&h.prototype;j.isValidRequiredData=function(k){'use strict';return Object.prototype.hasOwnProperty.call(k,'artist_name')&&Object.prototype.hasOwnProperty.call(k,'content_id')&&Object.prototype.hasOwnProperty.call(k,'has_minutiae')&&Object.prototype.hasOwnProperty.call(k,'minutiae_id')&&Object.prototype.hasOwnProperty.call(k,'music_id')&&Object.prototype.hasOwnProperty.call(k,'platform_name')&&Object.prototype.hasOwnProperty.call(k,'story_type');};function j(k){'use strict';if(!j.isValidRequiredData(k))throw new Error('Cannot create MusicStoryEventLogger, '+'RequiredData: '+JSON.stringify(k)+' is missing required fields ');i.constructor.call(this);this.$MusicStoryEventLogger1=k;this.$MusicStoryEventLogger2=-1;}j.prototype.logRequiredData=function(){'use strict';this.updateData(this.$MusicStoryEventLogger1);return this;};j.prototype.logAdditionalData=function(k){'use strict';this.updateData(k);return this;};j.prototype.logEvent=function(event){var k=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];'use strict';var l=[];switch(event){case c('MusicStoryLoggerEvents').CTA_CLICK:l.push('cta_action');break;case c('MusicStoryLoggerEvents').ERROR:l.push('error');break;case c('MusicStoryLoggerEvents').PLAY:l.push('audio_duration_ms');this.startPlaytimeTracker();break;case c('MusicStoryLoggerEvents').PAUSE:case c('MusicStoryLoggerEvents').REACHED_END:l.push('play_duration_ms');if(this.$MusicStoryEventLogger2<0)return;k.play_duration_ms=this.stopPlaytimeTracker();break;case c('MusicStoryLoggerEvents').STALL:break;default:break;}for(var m=l,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var p;if(n){if(o>=m.length)break;p=m[o++];}else{o=m.next();if(o.done)break;p=o.value;}var q=p;if(!Object.prototype.hasOwnProperty.call(k,q))throw new Error('The field: '+q+' must be logged with '+event);}this.logRequiredData().logAdditionalData(k).setEvent(event).log();this.clear();};j.prototype.startPlaytimeTracker=function(){'use strict';this.$MusicStoryEventLogger2=Date.now();};j.prototype.stopPlaytimeTracker=function(){'use strict';if(this.$MusicStoryEventLogger2<0)throw new Error('Cannot log event without a play event logged first');var k=Date.now()-this.$MusicStoryEventLogger2;this.$MusicStoryEventLogger2=-1;return k;};f.exports=j;}),null);
__d('MusicStoryLoggingStore',['AudioEvents','FluxReduceStore','immutable','MusicStoryAudioStore','MusicStoryDispatcher','MusicStoryEventLogger','MusicStoryLoggerEvents'],(function a(b,c,d,e,f,g){var h,i,j,k,l,m,n=1000,o={loggerIndex:c('immutable').Map(),soundcloudCheckpointIndex:c('immutable').Map()};h=babelHelpers.inherits(p,c('immutable').Record(o));i=h&&h.prototype;p.prototype.getLogger=function(s){'use strict';return this.get('loggerIndex').get(s);};p.prototype.getCheckpointTracker=function(s){'use strict';return this.get('soundcloudCheckpointIndex').get(s);};function p(){'use strict';h.apply(this,arguments);}j=babelHelpers.inherits(q,c('immutable').Record({lastUpdateTimeStamp:-1,timePlayedSinceLastCheckpoint:0}));k=j&&j.prototype;function q(){'use strict';j.apply(this,arguments);}l=babelHelpers.inherits(r,c('FluxReduceStore'));m=l&&l.prototype;r.prototype.getInitialState=function(){'use strict';return new p();};r.prototype.reduce=function(s,t){'use strict';var u=t.uniqueId,v=s.getLogger(u);if(v===null)return s;var w=c('MusicStoryAudioStore').getActiveTrackDurationMs(u),x=c('MusicStoryAudioStore').getActiveTrackTitle(u),y=c('MusicStoryAudioStore').getIsPlaying(u),z=c('MusicStoryAudioStore').getBeacons(u),aa=c('MusicStoryAudioStore').getIsDynamicURL(u);switch(t.type){case c('AudioEvents').CREATE_STREAM:var ba=t.loggingData;if(ba!=null){s=this.addLogger(s,u,ba);}else s=this.addNullLogger(s,u);s=this.addCheckpointTracker(s,u);break;case c('AudioEvents').PAUSE:if(aa){v.logEvent(c('MusicStoryLoggerEvents').PAUSE,{audio_duration_ms:w,audio_title:x,beacon_url:z.pause,clienttime:Date.now()});s=this.pauseCheckpointTracker(s,u);}v.logEvent(c('MusicStoryLoggerEvents').PAUSE,{audio_duration_ms:w,audio_title:x});break;case c('AudioEvents').PLAY:if(aa){v.logEvent(c('MusicStoryLoggerEvents').PLAY,{audio_duration_ms:w,audio_title:x,beacon_url:z.play,clienttime:Date.now()});s=this.startCheckpointTracker(s,u);}else v.logEvent(c('MusicStoryLoggerEvents').PLAY,{audio_duration_ms:w,audio_title:x});break;case c('AudioEvents').SCRUB_BEGIN:if(y)v.logEvent(c('MusicStoryLoggerEvents').PAUSE,{audio_duration_ms:w,audio_title:x});break;case c('AudioEvents').SCRUB_END:if(y)v.logEvent(c('MusicStoryLoggerEvents').PLAY,{audio_duration_ms:w,audio_title:x});break;case c('AudioEvents').FINISH:if(aa){s=this.pauseCheckpointTracker(s,u);v.logEvent(c('MusicStoryLoggerEvents').PAUSE,{audio_duration_ms:w,audio_title:x,beacon_url:z.stop,clienttime:Date.now()});}v.logEvent(c('MusicStoryLoggerEvents').REACHED_END,{audio_duration_ms:w,audio_title:x});break;case c('AudioEvents').STREAM_CHANGE:if(y)v.logEvent(c('MusicStoryLoggerEvents').PAUSE,{audio_duration_ms:w,audio_title:t.previousTitle});v.logEvent(c('MusicStoryLoggerEvents').PLAY,{audio_duration_ms:w,audio_title:x});break;case c('AudioEvents').UPDATE_TIME:if(aa){var ca=Date.now(),da=s.getCheckpointTracker(u),ea=da,fa=ea.lastUpdateTimeStamp,ga=ea.timePlayedSinceLastCheckpoint;if(fa>0){ga+=ca-fa;if(ga>29.5*n){var ha=z.checkpoint;v.logEvent('music_soundcloud_checkpoint',{beacon_url:ha,clienttime:Date.now()});ga=0;}fa=ca;da=da.set('lastUpdateTimeStamp',fa);da=da.set('timePlayedSinceLastCheckpoint',ga);var ia=s.get('soundcloudCheckpointIndex');ia=ia.set(u,da);s=s.set('soundcloudCheckpointIndex',ia);}}break;case c('AudioEvents').MUTE:case c('AudioEvents').UNMUTE:case c('AudioEvents').VOLUME_CHANGE:case c('AudioEvents').UPDATE_DURATION:case c('AudioEvents').UPDATE_BUFFER:break;}return s;};r.prototype.addLogger=function(s,t,u){'use strict';var v=s.get('loggerIndex');v=v.set(t,new (c('MusicStoryEventLogger'))(u));return s.set('loggerIndex',v);};r.prototype.addCheckpointTracker=function(s,t){'use strict';var u=s.get('soundcloudCheckpointIndex');u=u.set(t,new q());return s.set('soundcloudCheckpointIndex',u);};r.prototype.addNullLogger=function(s,t){'use strict';var u=s.get('loggerIndex');u=u.set(t,null);return s.set('loggerIndex',u);};r.prototype.pauseCheckpointTracker=function(s,t){'use strict';var u=s.getCheckpointTracker(t);u=u.set('lastUpdateTimeStamp',-1);var v=s.get('soundcloudCheckpointIndex');v=v.set(t,u);return s.set('soundcloudCheckpointIndex',v);};r.prototype.startCheckpointTracker=function(s,t){'use strict';var u=s.getCheckpointTracker(t);u=u.set('lastUpdateTimeStamp',Date.now());var v=s.get('soundcloudCheckpointIndex');v=v.set(t,u);return s.set('soundcloudCheckpointIndex',v);};function r(){'use strict';l.apply(this,arguments);}f.exports=new r(c('MusicStoryDispatcher'));}),null);
__d('MusicStoryBaseContainer.react',['AudioEvents','MusicStoryBanzaiFeedLogger','React','ReactComponentWithPureRenderMixin','MusicStoryAudioActions','MusicStoryAudioStore','MusicStoryLoggingStore','MusicStoryDispatcher'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.getStores=function(){'use strict';return [c('MusicStoryAudioStore'),c('MusicStoryLoggingStore')];};function j(k){'use strict';i.constructor.call(this,k);c('MusicStoryDispatcher').explicitlyRegisterStores([c('MusicStoryAudioStore'),c('MusicStoryLoggingStore')]);var l=k.loggingData,m=k.uniqueId,n=k.titleUriList,o=k.extraData,p=o.isDynamicUri;c('MusicStoryAudioActions').createStream(n,l,m,o,p);if(p){c('MusicStoryAudioActions').blockFetches(this.props.uniqueId);c('MusicStoryAudioActions').fetchURL(this.props.uniqueId,c('AudioEvents').CREATE_STREAM);}}j.prototype.play=function(){'use strict';c('MusicStoryBanzaiFeedLogger').logOutboundClick(this.props.ftKey);if(this.state.isDynamicUri){if(!this.state.blockFetches){c('MusicStoryAudioActions').blockFetches(this.props.uniqueId);c('MusicStoryAudioActions').fetchURL(this.props.uniqueId,c('AudioEvents').PLAY);}}else c('MusicStoryAudioActions').play(this.props.uniqueId);};j.prototype.pause=function(){'use strict';if(this.state.isDynamicUri){var k=c('MusicStoryAudioStore').getBeacons(this.props.uniqueId);c('MusicStoryAudioActions').pause(this.props.uniqueId,k.pause);}else c('MusicStoryAudioActions').pause(this.props.uniqueId);};j.prototype.scrubBegin=function(){'use strict';c('MusicStoryAudioActions').scrubBegin(this.props.uniqueId);};j.prototype.scrubEnd=function(k){'use strict';if(this.state.isDynamicUri){if(!this.state.blockFetches){c('MusicStoryAudioActions').blockFetches(this.props.uniqueId);c('MusicStoryAudioActions').fetchURL(this.props.uniqueId,c('AudioEvents').SCRUB_END,k);}}else c('MusicStoryAudioActions').scrubEnd(this.props.uniqueId,k);};j.prototype.mute=function(){'use strict';c('MusicStoryAudioActions').mute(this.props.uniqueId);};j.prototype.unmute=function(){'use strict';c('MusicStoryAudioActions').unmute(this.props.uniqueId);};j.prototype.toggleMuted=function(){'use strict';this.state.isMuted?this.unmute():this.mute();};j.prototype.changeVolume=function(k){'use strict';c('MusicStoryAudioActions').setVolume(this.props.uniqueId,k);};f.exports=j;}),null);
__d('MusicStoryCollectionListItem.react',['ix','cx','Image.react','React','ShimButton.react','XUIText.react','fbglyph'],(function a(b,c,d,e,f,g,h,i){var j=function k(l){var m=l.isPlaying,n=l.isActive,o=l.index,p=l.title,q=l.onTrackClick,r=void 0;if(m){r=c('React').createElement(c('Image.react'),{className:"_3-_y _3-4s",src:h("141376")});}else r=c('React').createElement(c('XUIText.react'),{className:"_3-4s",size:'small',weight:'normal'},o+1+'.');return c('React').createElement(c('ShimButton.react'),{className:"_3-4r"+(n?' '+"_59j3":''),onClick:function s(){return q(l.index);}},r,c('React').createElement(c('XUIText.react'),{className:"_3-4p",size:'small',weight:'normal'},p));};f.exports=j;}),null);
__d('MusicStoryCollectionTrackList.react',['cx','MusicStoryCollectionListItem.react','React','ScrollableArea.react'],(function a(b,c,d,e,f,g,h){var i=function j(k){var l=k.titleUriList.map(function(m,n){return c('React').createElement(c('MusicStoryCollectionListItem.react'),{key:n,index:n,title:m.title,uri:m.uri,isPlaying:k.isPlaying&&n===k.activeTrack,isActive:n===k.activeTrack,onTrackClick:k.onTrackClick});});return c('React').createElement(c('ScrollableArea.react'),{className:"_3cf2"},l);};f.exports=i;}),null);
__d('MusicStoryTrackListContainer.react',['MusicStoryBanzaiFeedLogger','FluxContainer','React','MusicStoryAudioActions','MusicStoryAudioStore','MusicStoryCollectionTrackList.react','MusicStoryBaseContainer.react'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('MusicStoryBaseContainer.react'));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this,k);this.$MusicStoryTrackListContainer1=this.onTrackClick.bind(this);}j.prototype.onTrackClick=function(k){'use strict';if(this.state.activeTrack===k){this.state.isPlaying?this.pause():this.play();}else{var l=this.props.uniqueId,m=c('MusicStoryAudioStore').getActiveTrackTitle(l);c('MusicStoryBanzaiFeedLogger').logOutboundClick(this.props.ftKey);c('MusicStoryAudioActions').changeStream(l,k,m);}};j.calculateState=function(k,l){'use strict';var m=l.uniqueId,n=c('MusicStoryAudioStore').getStream(m),o=n.activeTrack,p=n.bufferedPosition,q=n.isMuted,r=n.isPlaying,s=n.playbackPosition,t=n.volume,u=n.isFinished,v=n.duration,w={activeTrack:o,bufferedPosition:p,finishedPlaying:u,isMuted:q,isPlaying:r,playbackDuration:v,playbackPosition:s,volume:t,blockFetches:false,isDynamicUri:false};return w;};j.prototype.componentDidUpdate=function(k,l){var m,n=this;'use strict';if(!l.finishedPlaying&&this.state.finishedPlaying){var m=function(){var o=n.state.activeTrack+1;if(o>=n.props.titleUriList.length)return {v:void 0};setTimeout(function(){if(this.state.activeTrack!==o-1)return;c('MusicStoryAudioActions').changeStream(this.props.uniqueId,o,c('MusicStoryAudioStore').getActiveTrackTitle(this.props.uniqueId));}.bind(n),1500);}();if(typeof m==="object")return m.v;}};j.prototype.render=function(){'use strict';return c('React').createElement(c('MusicStoryCollectionTrackList.react'),{activeTrack:this.state.activeTrack,isPlaying:this.state.isPlaying,onTrackClick:this.$MusicStoryTrackListContainer1,uniqueId:this.props.uniqueId,titleUriList:this.props.titleUriList});};f.exports=c('FluxContainer').create(j,{withProps:true});}),null);
__d("XSpotifyWebAPIAuthDialogController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/music\/spotify\/auth\/",{__asyncDialog:{type:"Int"}});}),null);
__d("XSpotifyWebAPIIsAlbumSavedController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/music\/spotify\/is_album_saved\/",{});}),null);
__d("XSpotifyWebAPIIsSongSavedController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/music\/spotify\/is_song_saved\/",{});}),null);
__d("XSpotifyWebAPISaveAlbumController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/music\/spotify\/save_album\/",{});}),null);
__d("XSpotifyWebAPISaveSongController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/music\/spotify\/save_song\/",{});}),null);
__d("XSpotifyWebAPIUnsaveAlbumController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/music\/spotify\/unsave_album\/",{});}),null);
__d("XSpotifyWebAPIUnsaveSongController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/music\/spotify\/unsave_song\/",{});}),null);
__d('SimpleMusicStoryCTA',['cx','fbt','AsyncRequest','ChannelManager','CSS','DOM','MusicStoryAudioStore','MusicStoryLoggerEvents','MusicStoryEventLogger','MusicStoryBanzaiFeedLogger','RTISubscriptionManager','Run','XSpotifyWebAPIAuthDialogController','XSpotifyWebAPIIsAlbumSavedController','XSpotifyWebAPIIsSongSavedController','XSpotifyWebAPISaveAlbumController','XSpotifyWebAPISaveSongController','XSpotifyWebAPIUnsaveAlbumController','XSpotifyWebAPIUnsaveSongController','XSpotifyWebAPIControllerConstants'],(function a(b,c,d,e,f,g,h,i){c('ChannelManager').startChannelManager();j.authorize=function(k,l){'use strict';k.addEventListener('click',function(m){window.open(l);});};j.closeWindow=function(){'use strict';window.close();};function j(k,l,m){'use strict';this.$SimpleMusicStoryCTA1=m.album;this.$SimpleMusicStoryCTA3=k;this.$SimpleMusicStoryCTA9=l;this.$SimpleMusicStoryCTA16=m.uri;this.$SimpleMusicStoryCTA6=m.saved;this.$SimpleMusicStoryCTA7=false;this.$SimpleMusicStoryCTA8=m.loggedIn;this.$SimpleMusicStoryCTA2=m.appName;this.$SimpleMusicStoryCTA11=false;this.$SimpleMusicStoryCTA15=m.ftkey;this.$SimpleMusicStoryCTA19=m.uniqueId;this.$SimpleMusicStoryCTA20=m.isDynamicUri;var n=m.loggingData;if(n!==null){this.$SimpleMusicStoryCTA4=new (c('MusicStoryEventLogger'))(n);this.$SimpleMusicStoryCTA7=true;}switch(this.$SimpleMusicStoryCTA2){case 'Spotify':this.$SimpleMusicStoryCTA13=i._("Agregar a Spotify");this.$SimpleMusicStoryCTA17=i._("Se agreg\u00f3 a Spotify");this.$SimpleMusicStoryCTA10=this.onSpotifyClick;break;case 'iTunes':this.$SimpleMusicStoryCTA13=i._("Cons\u00edguela en iTunes");this.$SimpleMusicStoryCTA17='';this.$SimpleMusicStoryCTA10=this.onDefaultClick;break;default:var o=this.$SimpleMusicStoryCTA2;this.$SimpleMusicStoryCTA13=i._("Escuchar en {partnerName}",[i.param('partnerName',o)]);this.$SimpleMusicStoryCTA17='';this.$SimpleMusicStoryCTA10=this.onDefaultClick;}if(this.$SimpleMusicStoryCTA6){c('DOM').setContent(this.$SimpleMusicStoryCTA9,this.$SimpleMusicStoryCTA17);this.setUnsaveWidth();}else{c('DOM').setContent(this.$SimpleMusicStoryCTA9,this.$SimpleMusicStoryCTA13);this.setSaveWidth();}k.addEventListener('click',function(p){if(!this.$SimpleMusicStoryCTA11){this.$SimpleMusicStoryCTA11=true;this.$SimpleMusicStoryCTA10.bind(this)();setTimeout(function(){this.$SimpleMusicStoryCTA11=false;}.bind(this),500);}}.bind(this));if(this.$SimpleMusicStoryCTA8)c('Run').onAfterLoad(this.checkIsSaved.bind(this));}j.prototype.checkIsSaved=function(){'use strict';var k=void 0,l=void 0;if(this.$SimpleMusicStoryCTA1){k=c('XSpotifyWebAPIIsAlbumSavedController').getURIBuilder().getURI();l={album_url:this.$SimpleMusicStoryCTA16};}else{k=c('XSpotifyWebAPIIsSongSavedController').getURIBuilder().getURI();l={song_url:this.$SimpleMusicStoryCTA16};}new (c('AsyncRequest'))().setURI(k).setMethod('POST').setData(l).setHandler(function(m){this.onSavedResponse(m);}.bind(this)).send();};j.prototype.onSavedResponse=function(k){'use strict';var l=k.payload;if(l)this.showAsSaved();};j.prototype.onSpotifyClick=function(){'use strict';c('MusicStoryBanzaiFeedLogger').logOutboundClick(this.$SimpleMusicStoryCTA15);if(!this.$SimpleMusicStoryCTA6){this.save();}else this.unsave();};j.prototype.onDefaultClick=function(){'use strict';c('MusicStoryBanzaiFeedLogger').logOutboundClick(this.$SimpleMusicStoryCTA15);var k=this.$SimpleMusicStoryCTA20?{cta_action:'webview',beacon_url:c('MusicStoryAudioStore').getBeacons(this.$SimpleMusicStoryCTA19).ctaClickOpen,clienttime:Date.now()}:{cta_action:'webview'};this.logEvent(c('MusicStoryLoggerEvents').CTA_CLICK,k);window.open(this.$SimpleMusicStoryCTA16);};j.prototype.authorize=function(){'use strict';var k=c('XSpotifyWebAPIAuthDialogController').getURIBuilder().getURI();this.subscribeToSpotifyLogin(this.onSpotifyClick.bind(this));new (c('AsyncRequest'))().setURI(k).setMethod('POST').send();};j.prototype.save=function(){var k=arguments.length<=0||arguments[0]===undefined?true:arguments[0];'use strict';var l=void 0,m=void 0;if(this.$SimpleMusicStoryCTA1){l=c('XSpotifyWebAPISaveAlbumController').getURIBuilder().getURI();m={album_url:this.$SimpleMusicStoryCTA16};}else{l=c('XSpotifyWebAPISaveSongController').getURIBuilder().getURI();m={song_url:this.$SimpleMusicStoryCTA16};}new (c('AsyncRequest'))().setURI(l).setMethod('POST').setData(m).setHandler(function(n){this.onServerResponse(n,k);}.bind(this)).send();};j.prototype.onSaveSuccess=function(){'use strict';this.logEvent(c('MusicStoryLoggerEvents').CTA_CLICK,{cta_action:'spotify_save'});this.showAsSaved();};j.prototype.unsave=function(){var k=arguments.length<=0||arguments[0]===undefined?true:arguments[0];'use strict';var l=void 0,m=void 0;if(this.$SimpleMusicStoryCTA1){l=c('XSpotifyWebAPIUnsaveAlbumController').getURIBuilder().getURI();m={album_url:this.$SimpleMusicStoryCTA16};}else{l=c('XSpotifyWebAPIUnsaveSongController').getURIBuilder().getURI();m={song_url:this.$SimpleMusicStoryCTA16};}new (c('AsyncRequest'))().setURI(l).setMethod('POST').setData(m).setHandler(function(n){this.onServerResponse(n,k);}.bind(this)).send();};j.prototype.onUnsaveSuccess=function(){'use strict';this.logEvent(c('MusicStoryLoggerEvents').CTA_CLICK,{cta_action:'spotify_unsave'});this.showAsUnsaved();};j.prototype.showAsSaved=function(){'use strict';this.doSaveAnimation();this.$SimpleMusicStoryCTA6=true;};j.prototype.showAsUnsaved=function(){'use strict';this.doUnsaveAnimation();this.$SimpleMusicStoryCTA6=false;};j.prototype.onServerResponse=function(k,l){'use strict';k=k.payload;if(k===c('XSpotifyWebAPIControllerConstants').SAVE_SUCCESS){this.onSaveSuccess();}else if(k===c('XSpotifyWebAPIControllerConstants').UNSAVE_SUCCESS){this.onUnsaveSuccess();}else if(k===c('XSpotifyWebAPIControllerConstants').LOGIN_REQUIRED&&l){this.authorize();}else this.logEvent(c('MusicStoryLoggerEvents').CTA_CLICK,{cta_action:'spotify_login_fail'});};j.prototype.doSaveAnimation=function(){'use strict';this.$SimpleMusicStoryCTA3.offsetWidth;c('CSS').addClass(this.$SimpleMusicStoryCTA3,"_1t00");setTimeout(function(){c('DOM').setContent(this.$SimpleMusicStoryCTA9,this.$SimpleMusicStoryCTA17);}.bind(this),120);this.setUnsaveWidth();};j.prototype.doUnsaveAnimation=function(){'use strict';c('CSS').removeClass(this.$SimpleMusicStoryCTA3,"_1t00");setTimeout(function(){c('DOM').setContent(this.$SimpleMusicStoryCTA9,this.$SimpleMusicStoryCTA13);}.bind(this),120);this.setSaveWidth();};j.prototype.setSaveWidth=function(){'use strict';this.$SimpleMusicStoryCTA3.style.width=this.getWidthOfText(this.$SimpleMusicStoryCTA13,'14')+20+46+'px';};j.prototype.setUnsaveWidth=function(){'use strict';this.$SimpleMusicStoryCTA3.style.width=this.getWidthOfText(this.$SimpleMusicStoryCTA17,'14')+20+56+'px';};j.prototype.getWidthOfText=function(k,l){'use strict';var m=document.createElement('canvas'),n=m.getContext('2d');n.font=l+'px';var o=n.measureText(k).width;return o;};j.prototype.subscribeToSpotifyLogin=function(){'use strict';c('RTISubscriptionManager').subscribe('music/auth_code_received/success',function(k){this.save(false);c('RTISubscriptionManager').unsubscribe('music/auth_code_received/success');}.bind(this));};j.prototype.logEvent=function(event,k){'use strict';if(this.$SimpleMusicStoryCTA7)this.$SimpleMusicStoryCTA4.logEvent(event,k);};f.exports=j;}),null);
__d('SimpleMusicAudioControls.react',['cx','EmbeddedVideoPlaybackControl.react','EmbeddedVideoPlaybackTimer.react','React','EmbeddedVideoScrubber.react','EmbeddedVideoVolumeControl.react'],(function a(b,c,d,e,f,g,h){var i=function j(k){var l="_2mbj _2mbk",m="_2mbj _yaw",n="_2mbj _409j",o="_i5q",p=k.playbackPosition-k.playbackDuration,q=c('React').createElement(c('EmbeddedVideoPlaybackTimer.react'),{className:"_25e2",remainingTimestamp:Math.round(p),playbackPosTimestamp:k.playbackPosition}),r=c('React').createElement(c('EmbeddedVideoPlaybackControl.react'),{finishedPlaying:k.finishedPlaying,isPlaying:k.isPlaying,onPause:k.onPause,onPlay:k.onPlay,tabIndex:'0'}),s=c('React').createElement(c('EmbeddedVideoScrubber.react'),{bufferedPosition:k.bufferedPosition,onScrubBegin:k.onScrubBegin,onScrubEnd:k.onScrubEnd,playbackDuration:k.playbackDuration,playbackPosition:k.playbackPosition,tabIndex:'0'}),t=c('React').createElement(c('EmbeddedVideoVolumeControl.react'),{isMuted:k.isMuted,onToggleMuted:k.onToggleMuted,onVolumeChange:k.onVolumeChange,volume:k.volume,tabIndex:'0'});return c('React').createElement('div',{className:o},c('React').createElement('div',{className:"_4lqt"},c('React').createElement('div',{className:"_5rbl"},c('React').createElement('div',{className:"_2mbh"},c('React').createElement('div',{className:l},r),c('React').createElement('div',{className:m},s),c('React').createElement('div',{className:n},q,t)))));};f.exports=i;}),null);
__d('MusicStoryAudioControlsContainer.react',['SimpleMusicAudioControls.react','FluxContainer','React','MusicStoryAudioStore','MusicStoryBaseContainer.react'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('MusicStoryBaseContainer.react'));i=h&&h.prototype;j.calculateState=function(k,l){'use strict';var m=l.uniqueId,n=c('MusicStoryAudioStore').getStream(m),o=n.bufferedPosition,p=n.isMuted,q=n.isPlaying,r=n.playbackPosition,s=n.volume,t=n.isFinished,u=n.duration,v=n.isDynamicUri,w=n.blockFetches,x={bufferedPosition:o,finishedPlaying:t,isMuted:p,isPlaying:q,playbackDuration:u,playbackPosition:r,volume:s,isDynamicUri:v,blockFetches:w};return x;};j.prototype.render=function(){'use strict';return c('React').createElement(c('SimpleMusicAudioControls.react'),babelHelpers['extends']({onPlay:this.play.bind(this),onPause:this.pause.bind(this),onScrubBegin:this.scrubBegin.bind(this),onScrubEnd:this.scrubEnd.bind(this),onToggleMuted:this.toggleMuted.bind(this),onVolumeChange:this.changeVolume.bind(this)},this.state));};function j(){'use strict';h.apply(this,arguments);}f.exports=c('FluxContainer').create(j,{withProps:true});}),null);